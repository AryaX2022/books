import{m as O,r,k as T,c as i,g as t,a as e,t as f,h as p,f as w,C as x,F as $,j as I,B as P,b as y,w as b,s as M,_ as W,o as l,d as k}from"./entry.cea0bdbc.js";import{a as q,_ as G}from"./reglogin.2c1dac89.js";import{a as J}from"./upgrade.9a4f9f4e.js";import{a as K,u as F}from"./useMyFetch.dffdcfee.js";const Q={class:"flex flex-col justify-center gap-y-4 mt-10"},R={key:0,class:"flex self-center bg-yellow-100 rounded-lg p-3 text-sm text-gray-700",role:"alert"},X=e("svg",{class:"w-5 h-5 inline mr-3",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})],-1),Y={key:1,class:"flex flex-col md:min-w-[42rem] self-center"},Z={class:"mx-4 self-center flex flex-col gap-y-3 px-8 py-6 bg-gray-50 rounded-lg shadow-md"},ee={class:"relative flex flex-wrap items-end gap-x-2"},te=["src"],se={class:"flex items-center"},ae=e("img",{src:"https://epubjs.netlify.app/ajax-loader.gif"},null,-1),oe=[ae],le=e("svg",{t:"1697531612958",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2345",width:"22",height:"22"},[e("path",{d:"M512 42.666667c259.2 0 469.333333 210.133333 469.333333 469.333333s-210.133333 469.333333-469.333333 469.333333S42.666667 771.2 42.666667 512 252.8 42.666667 512 42.666667z m0 64C288.149333 106.666667 106.666667 288.149333 106.666667 512s181.482667 405.333333 405.333333 405.333333 405.333333-181.482667 405.333333-405.333333S735.850667 106.666667 512 106.666667z m-104.746667 256a8.533333 8.533333 0 0 1 6.037334 2.496L512 463.850667l98.688-98.688a8.533333 8.533333 0 0 1 6.037333-2.496h66.346667a8.533333 8.533333 0 0 1 6.037333 14.570666l-131.84 131.861334 137.642667 137.664a8.533333 8.533333 0 0 1-6.037333 14.570666h-66.346667a8.533333 8.533333 0 0 1-6.037333-2.496L512 554.346667l-104.512 104.490666a8.533333 8.533333 0 0 1-6.037333 2.496h-66.346667a8.533333 8.533333 0 0 1-6.016-14.570666l137.664-137.664-131.861333-131.861334A8.533333 8.533333 0 0 1 340.906667 362.666667h66.346666z",fill:"#707070","p-id":"2346"})],-1),ne=[le],re={class:"absolute top-6 left-10"},ie={class:"relative flex flex-wrap gap-2 p-3 h-80 bg-gray-700 rounded-lg shadow-lg shadow-amber-100 overflow-auto"},ce=["src","onClick"],de=e("div",{class:"bg-gray-50 rounded-lg w-10 h-10 flex justify-center items-center"},[e("label",null,[e("div",{class:"cursor-pointer text-sm flex text-center",title:"自定义.."},"上传📷"),e("input",{id:"imguploader",type:"file",style:{display:"none"},accept:"image/*"})])],-1),ue={class:"text-gray-800 text-xl"},pe={class:"text-gray-400 text-sm"},he={key:0,class:"flex flex-row items-center"},ge=e("svg",{t:"1697687669826",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"9132",width:"26",height:"26"},[e("path",{d:"M235.3 140.6h551.8c38.8 0 73.7 23.5 88.4 59.4l70.3 171.9c13.9 33.9 7.1 72.7-17.3 99.9L588.2 851.6c-37.3 41.6-102.1 42.5-140.5 1.9L88 473.8C61.3 445.6 54.3 404 70.3 368.7l78-172c15.5-34.2 49.5-56.1 87-56.1z",fill:"#FAB001","p-id":"9133"}),e("path",{d:"M861 348.7l-70.3-171.9c-5.9-14.3-15-26.5-26.3-36.2H235.3c-37.5 0-71.5 21.9-87 56.1l-78 172c-16 35.4-9.1 76.9 17.7 105.1l359.7 379.7c1.5 1.6 3.1 3 4.7 4.5 19-4.1 36.9-14 50.9-29.6l340.4-379.9c24.4-27.2 31.2-66 17.3-99.8z",fill:"#F9E48A","p-id":"9134"}),e("path",{d:"M807.9 219H302.1c-37.5 0-71.5 21.9-87 56.1l-78 172c-11.5 25.5-11 54.1 0.1 78.6l310.5 327.8c1.5 1.6 3.1 3 4.7 4.5 19-4.1 36.9-14 50.9-29.6l340.4-379.9c24.4-27.3 31.1-66.1 17.3-99.9L807.9 219z",fill:"#FECE0A","p-id":"9135"}),e("path",{d:"M669.6 438.9H336.8c-2.9 0-5.2-2.3-5.2-5.2v-89.3c0-2.9 2.3-5.2 5.2-5.2h332.7c2.9 0 5.2 2.3 5.2 5.2v89.3c0.1 2.9-2.2 5.2-5.1 5.2z",fill:"#FFFFFF","p-id":"9136"})],-1),fe={key:1},me=e("svg",{t:"1697687669826",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"9132",width:"26",height:"26"},[e("path",{d:"M235.3 140.6h551.8c38.8 0 73.7 23.5 88.4 59.4l70.3 171.9c13.9 33.9 7.1 72.7-17.3 99.9L588.2 851.6c-37.3 41.6-102.1 42.5-140.5 1.9L88 473.8C61.3 445.6 54.3 404 70.3 368.7l78-172c15.5-34.2 49.5-56.1 87-56.1z",fill:"#FAB001","p-id":"9133"}),e("path",{d:"M861 348.7l-70.3-171.9c-5.9-14.3-15-26.5-26.3-36.2H235.3c-37.5 0-71.5 21.9-87 56.1l-78 172c-16 35.4-9.1 76.9 17.7 105.1l359.7 379.7c1.5 1.6 3.1 3 4.7 4.5 19-4.1 36.9-14 50.9-29.6l340.4-379.9c24.4-27.2 31.2-66 17.3-99.8z",fill:"#F9E48A","p-id":"9134"}),e("path",{d:"M807.9 219H302.1c-37.5 0-71.5 21.9-87 56.1l-78 172c-11.5 25.5-11 54.1 0.1 78.6l310.5 327.8c1.5 1.6 3.1 3 4.7 4.5 19-4.1 36.9-14 50.9-29.6l340.4-379.9c24.4-27.3 31.1-66.1 17.3-99.9L807.9 219z",fill:"#FECE0A","p-id":"9135"}),e("path",{d:"M669.6 438.9H336.8c-2.9 0-5.2-2.3-5.2-5.2v-89.3c0-2.9 2.3-5.2 5.2-5.2h332.7c2.9 0 5.2 2.3 5.2 5.2v89.3c0.1 2.9-2.2 5.2-5.1 5.2z",fill:"#FFFFFF","p-id":"9136"})],-1),ve=e("span",{class:"ml-1"},"成为超级会员，无限下载",-1),_e=[me,ve],we={class:"flex gap-3"},xe={key:2},Ae={__name:"profile",setup(ye){const s=O();r();const c=r(""),m=r(""),h=r(!1),u=r(null),v=r(!1),d=r(!1);function C(){d.value=!0}function z(){d.value=!1}function B(o){s.user.avatar=o,d.value=!1,F("/userupdate",{method:"post",body:{avatar:o}})}r(!1);function j(){s.update({}),c.value="已退出登录！",m.value=new Date().getTime().toString()}function L(){c.value="恭喜，您已注册成功！",m.value=new Date().getTime().toString(),console.log(c.value)}function S(){c.value="您已经成功登录！",m.value=new Date().getTime().toString(),console.log(c.value)}function E(){const o=document.getElementById("imguploader");console.log(o),o!=null&&(o.onchange=()=>{v.value=!0;var n=o.files[0],a=new FormData;a.append("image",n),K("https://api.imgbb.com/1/upload?key=1609ad5c658c52faf7d11488e5f83c11",{method:"post",body:a},"$62j1b1lrVm").then(g=>{s.user.avatar=g.data.value.data.url,F("/userupdate",{method:"post",body:{avatar:g.data.value.data.url}}).then(A=>{v.value=!1})}),d.value=!1})}function H(o,n){var a=new Date(o);return a.setDate(a.getDate()+n),a}function V(){Object.keys(s.user).length>0&&F("/getpayment").then(o=>{var n=o.data.value.find(a=>a.order_type===1||a.order_type===2);n!=null?(h.value=!0,console.log(n.ptime),u.value=H(n.ptime,n.order_content)):h.value=!1})}T(()=>{E(),V()});const _=r(!1);function U(){_.value=!1}function N(){_.value=!0}return(o,n)=>{const a=W,g=G,A=J;return l(),i("div",Q,[t(c).length>0?(l(),i("div",R,[X,e("div",null,f(t(c)),1)])):p("",!0),Object.keys(t(s).user).length>0?(l(),i("div",Y,[e("div",Z,[e("div",ee,[e("img",{class:"w-32 h-32 cursor-pointer rounded-2xl",src:t(s).user.avatar.startsWith("http")?t(s).user.avatar:"/avatar/"+t(s).user.avatar,onClick:C},null,8,te),w(e("div",se,oe,512),[[x,t(v)]]),e("span",{class:"text-sm text-gray-500 underline underline-offset-4 cursor-pointer hover:text-gray-400",onClick:C},"更换头像"),w(e("div",{class:"absolute right-[-1.5rem] top-3 cursor-pointer",onClick:z},ne,512),[[x,t(d)]]),w(e("div",re,[e("div",ie,[(l(!0),i($,null,I(t(q),D=>(l(),i("img",{class:"w-12 h-12 cursor-pointer rounded-2xl",src:"/avatar/"+D,onClick:be=>B(D)},null,8,ce))),256)),de,e("div",{class:"bg-gray-50 rounded-lg w-10 h-10 flex justify-center items-center cursor-pointer",onClick:z}," 取消 ")])],512),[[x,t(d)]])]),e("span",ue,f(t(s).user.username),1),e("span",pe,"注册于 "+f(new Date(t(s).user.regtime).toLocaleString()),1),t(h)?(l(),i("div",he,[ge,e("span",{class:P(["ml-1 text-sm",{"text-gray-400":t(u)<new Date,"text-amber-600":t(u)>=new Date}])},"超级用户资格有效期至 "+f(t(u).toLocaleString()),3)])):p("",!0),!t(h)||t(u)<new Date?(l(),i("div",fe,[e("button",{class:"inline-flex items-center justify-center rounded-lg bg-[#4A708B] py-1 px-2 font-sans text-xs font-bold uppercase text-white shadow-md shadow-orange-500/20 transition-all hover:shadow-lg hover:shadow-orange-500/40 focus:opacity-[0.85] focus:shadow-none active:opacity-[0.85] active:shadow-none disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none","data-ripple-light":"true",onClick:N},_e)])):p("",!0)]),y(a,{to:"/sharing",class:"self-center my-6 text-sm text-orange-600 hover:text-orange-800"},{default:b(()=>[k("🔥 分享即免费获得超级会员活动开启啦 🔥")]),_:1}),e("a",{onClick:j,class:"cursor-pointer self-center mt-6 underline underline-offset-4 text-gray-500"},"退出登录"),e("div",we,[Object.keys(t(s).user).length>0&&t(s).user.username==="admin"?(l(),M(a,{key:0,to:"/mnguserapply"},{default:b(()=>[k("管理用户提交-books")]),_:1})):p("",!0),Object.keys(t(s).user).length>0&&t(s).user.username==="admin"?(l(),M(a,{key:1,to:"/ziyuanmnguserapply"},{default:b(()=>[k("管理用户提交-ziyuan")]),_:1})):p("",!0)])])):(l(),i("div",xe,[y(g,{onAfterregister:L,onAfterlogin:S})])),y(A,{onCloseUpgrade:U,"show-model":t(_)},null,8,["show-model"])])}}};export{Ae as default};
